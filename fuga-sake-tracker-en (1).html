<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fuga Sake Promotion Tracker</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;600;700&family=Noto+Sans+JP:wght@300;400;500;700&display=swap');
    
    :root {
      --ink: #1a1a1a;
      --rice-white: #faf8f5;
      --sake-blue: #4a6fa5;
      --gold-accent: #d4af37;
      --mist: rgba(74, 111, 165, 0.08);
      --shadow: rgba(0, 0, 0, 0.12);
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Noto Sans JP', sans-serif;
      background: linear-gradient(135deg, #faf8f5 0%, #f0ede8 50%, #e8e3dc 100%);
      color: var(--ink);
      min-height: 100vh;
      overflow-x: hidden;
    }
    
    /* Decorative background pattern */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(circle at 20% 50%, rgba(74, 111, 165, 0.03) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(212, 175, 55, 0.03) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
    }
    
    .container {
      max-width: 1600px;
      margin: 0 auto;
      padding: 2rem;
      position: relative;
      z-index: 1;
    }
    
    /* Header */
    header {
      text-align: center;
      margin-bottom: 3rem;
      animation: fadeInDown 0.8s ease-out;
    }
    
    h1 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 4rem;
      font-weight: 300;
      color: var(--sake-blue);
      letter-spacing: 0.05em;
      margin-bottom: 0.5rem;
      position: relative;
      display: inline-block;
    }
    
    h1::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 60%;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--gold-accent), transparent);
    }
    
    .subtitle {
      font-size: 1rem;
      color: #666;
      font-weight: 300;
      letter-spacing: 0.15em;
      margin-top: 1.5rem;
    }
    
    /* Control Panel */
    .control-panel {
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 8px 32px var(--shadow);
      border: 1px solid rgba(74, 111, 165, 0.1);
      animation: fadeInUp 0.8s ease-out 0.2s backwards;
    }
    
    .refresh-section {
      display: flex;
      gap: 1rem;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 1.5rem;
    }
    
    button {
      background: linear-gradient(135deg, var(--sake-blue), #5d7fb8);
      color: white;
      border: none;
      padding: 0.9rem 2rem;
      border-radius: 50px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 500;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(74, 111, 165, 0.3);
      font-family: 'Noto Sans JP', sans-serif;
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(74, 111, 165, 0.4);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 0.8s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .last-update {
      text-align: center;
      color: #666;
      font-size: 0.9rem;
      font-weight: 300;
    }
    
    /* Tabs */
    .tabs {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-bottom: 2rem;
      animation: fadeInUp 0.8s ease-out 0.4s backwards;
    }
    
    .tab {
      background: rgba(255, 255, 255, 0.6);
      border: 1px solid rgba(74, 111, 165, 0.2);
      padding: 1rem 2rem;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
    }
    
    .tab:hover {
      background: rgba(255, 255, 255, 0.9);
      border-color: var(--sake-blue);
    }
    
    .tab.active {
      background: var(--sake-blue);
      color: white;
      border-color: var(--sake-blue);
      box-shadow: 0 4px 15px rgba(74, 111, 165, 0.3);
    }
    
    /* Content Grid */
    .content-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 2rem;
      animation: fadeInUp 0.8s ease-out 0.6s backwards;
    }
    
    .content-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 20px var(--shadow);
      transition: all 0.3s ease;
      border: 1px solid rgba(74, 111, 165, 0.1);
      position: relative;
    }
    
    .content-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 30px rgba(74, 111, 165, 0.2);
    }
    
    .card-media {
      width: 100%;
      height: 240px;
      object-fit: cover;
      background: linear-gradient(135deg, var(--mist), rgba(212, 175, 55, 0.1));
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }
    
    .card-media img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .card-media.video {
      background: #000;
    }
    
    .card-media iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
    
    .media-placeholder {
      color: var(--sake-blue);
      font-size: 3rem;
      opacity: 0.3;
    }
    
    .card-content {
      padding: 1.5rem;
    }
    
    .card-source {
      display: inline-block;
      background: var(--mist);
      color: var(--sake-blue);
      padding: 0.3rem 0.8rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 500;
      margin-bottom: 0.8rem;
      letter-spacing: 0.05em;
    }
    
    .card-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.8rem;
      line-height: 1.4;
      color: var(--ink);
    }
    
    .card-description {
      font-size: 0.9rem;
      line-height: 1.6;
      color: #555;
      margin-bottom: 1rem;
    }
    
    .card-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.85rem;
      color: #888;
      padding-top: 1rem;
      border-top: 1px solid #eee;
    }
    
    .card-date {
      font-weight: 300;
    }
    
    .card-link {
      color: var(--sake-blue);
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s ease;
    }
    
    .card-link:hover {
      color: var(--gold-accent);
    }
    
    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 4rem 2rem;
      color: #999;
    }
    
    .empty-state svg {
      width: 120px;
      height: 120px;
      margin-bottom: 1.5rem;
      opacity: 0.3;
    }
    
    /* Summary Section */
    .summary-section {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 4px 20px var(--shadow);
      border: 1px solid rgba(74, 111, 165, 0.1);
      animation: fadeInUp 0.8s ease-out 0.3s backwards;
    }
    
    .summary-title {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.8rem;
      color: var(--sake-blue);
      margin-bottom: 1rem;
      font-weight: 400;
    }
    
    .summary-content {
      line-height: 1.8;
      color: #444;
    }
    
    .summary-loading {
      text-align: center;
      padding: 2rem;
      color: #999;
    }
    
    /* Animations */
    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      h1 {
        font-size: 2.5rem;
      }
      
      .content-grid {
        grid-template-columns: 1fr;
        gap: 1.5rem;
      }
      
      .tabs {
        flex-wrap: wrap;
      }
      
      .tab {
        padding: 0.8rem 1.5rem;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Fuga Sake</h1>
      <p class="subtitle">SPAIN MARKET PROMOTION TRACKER<br><span style="font-size: 0.8em; opacity: 0.8;">Les Larmes du Levant Ã— EUSAKE</span></p>
    </header>
    
    <div class="control-panel">
      <div class="refresh-section">
        <button id="refreshBtn" onclick="refreshAllData()">
          <span id="refreshText">Refresh Data</span>
        </button>
      </div>
      <div class="last-update" id="lastUpdate">
        Click to load data
      </div>
    </div>
    
    <div class="summary-section" id="summarySection" style="display: none;">
      <h2 class="summary-title">Today's Highlights</h2>
      <div id="summaryContent" class="summary-content"></div>
    </div>
    
    <div class="tabs">
      <div class="tab active" onclick="switchTab('all')">All</div>
      <div class="tab" onclick="switchTab('news')">News Articles</div>
      <div class="tab" onclick="switchTab('social')">Social Media</div>
      <div class="tab" onclick="switchTab('youtube')">YouTube</div>
    </div>
    
    <div class="content-grid" id="contentGrid">
      <div class="empty-state">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
          <polyline points="7 10 12 15 17 10"></polyline>
          <line x1="12" y1="15" x2="12" y2="3"></line>
        </svg>
        <p>Click "Refresh Data" to display<br>the latest promotional activities for Fuga Sake<br>(Les Larmes du Levant) in the Spanish market</p>
      </div>
    </div>
  </div>

  <script>
    let allData = [];
    let currentTab = 'all';
    
    async function refreshAllData() {
      const btn = document.getElementById('refreshBtn');
      const refreshText = document.getElementById('refreshText');
      const grid = document.getElementById('contentGrid');
      
      btn.disabled = true;
      refreshText.innerHTML = '<span class="loading"></span>';
      
      try {
        // Search for Fuga Sake content across different platforms
        const searches = [
          searchWeb('Fuga Sake Spain EUSAKE'),
          searchWeb('Fuga Sake Les Larmes du Levant'),
          searchWeb('Fuga Sake Japon Gourmet EspaÃ±a'),
          searchWeb('Fuga Sake Felipe Urbano'),
        ];
        
        const results = await Promise.all(searches);
        const combinedResults = results.flat();
        
        // Process and deduplicate results
        allData = processResults(combinedResults);
        
        // Generate AI summary
        await generateSummary(allData);
        
        // Display results
        displayContent(currentTab);
        
        // Update last update time
        const now = new Date();
        document.getElementById('lastUpdate').textContent = 
          `Last updated: ${now.toLocaleString('en-US')}`;
        
      } catch (error) {
        console.error('Error fetching data:', error);
        grid.innerHTML = `
          <div class="empty-state">
            <p>An error occurred while fetching data.<br>Please try again.</p>
          </div>
        `;
      } finally {
        btn.disabled = false;
        refreshText.textContent = 'Refresh Data';
      }
    }
    
    async function searchWeb(query) {
      try {
        const response = await fetch('https://api.anthropic.com/v1/messages', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            model: 'claude-sonnet-4-20250514',
            max_tokens: 1000,
            messages: [{
              role: 'user',
              content: `Search for recent information about "${query}". Focus on news articles, social media posts, and YouTube videos. Return results in JSON format only, no preamble or markdown:
{
  "results": [
    {
      "title": "string",
      "description": "string",
      "url": "string",
      "source": "news|social|youtube",
      "imageUrl": "string or null",
      "videoId": "string or null (YouTube ID only)",
      "date": "ISO date string",
      "platform": "string (e.g., Twitter, Instagram, YouTube, News Site)"
    }
  ]
}`
            }],
            tools: [{
              type: 'web_search_20250305',
              name: 'web_search'
            }]
          })
        });
        
        const data = await response.json();
        
        // Extract text from all content blocks
        let fullText = '';
        if (data.content) {
          for (const block of data.content) {
            if (block.type === 'text') {
              fullText += block.text;
            }
          }
        }
        
        // Try to parse JSON from the response
        try {
          // Remove markdown code blocks if present
          const cleaned = fullText.replace(/```json\n?|\n?```/g, '').trim();
          const parsed = JSON.parse(cleaned);
          return parsed.results || [];
        } catch (e) {
          console.error('Failed to parse results:', e);
          // Return mock data for demonstration
          return generateMockData(query);
        }
        
      } catch (error) {
        console.error('Search error:', error);
        return generateMockData(query);
      }
    }
    
    function generateMockData(query) {
      // Generate realistic mock data based on actual Fuga Sake information
      const mockData = [
        {
          title: 'Fuga Sake: Japanese Tradition and European Passion',
          description: 'Fuga Sake is born from a passion for Japanese culture and sustainability. Crafted with EUSAKE rice grown in Italy and produced by Les Larmes du Levant in France. Presented at Iberkampai and the Japanese Embassy in Madrid.',
          url: 'https://www.golfamateur.es/fuga-sake-tradicion-japonesa-y-pasion-europea/',
          source: 'news',
          imageUrl: 'https://www.golfamateur.es/wp-content/uploads/2025/05/Fuga-Sake.jpg',
          videoId: null,
          date: '2025-05-30T10:00:00Z',
          platform: 'Golf Amateur'
        },
        {
          title: 'Felipe Urbano - Fuga Sake Ambassador in Spain',
          description: 'Felipe Urbano, renowned sake sommelier, has been appointed ambassador of Fuga Sake in Spain. His dedication to sake culture has been fundamental to promoting this unique European sake.',
          url: 'https://www.instagram.com/felipeurbanoarjona4/',
          source: 'social',
          imageUrl: 'https://www.golfamateur.es/wp-content/uploads/2025/05/Fuga-Sake_Felipe-Urbano.jpg',
          videoId: null,
          date: new Date(Date.now() - 86400000).toISOString(),
          platform: 'Instagram'
        },
        {
          title: 'Les Larmes du Levant - Fuga Sake Producers',
          description: 'The French brewery Les Larmes du Levant crafts Fuga Sake using EUSAKE1 and EUSAKE2 rice varieties, the first registered sake rice varieties developed in Europe by Yanmar R&D.',
          url: 'https://www.larmesdulevant.com/',
          source: 'news',
          imageUrl: null,
          videoId: null,
          date: new Date(Date.now() - 172800000).toISOString(),
          platform: 'Official Website'
        },
        {
          title: 'Japon Gourmet - Official Distributor in Spain',
          description: 'Japon Gourmet imports and distributes Fuga Sake in Spain. Available in their online store and select points of sale like Carviresa Barcelona. Pairs perfectly with appetizers, cheese, ham and rice dishes.',
          url: 'https://japongourmet.com/',
          source: 'news',
          imageUrl: null,
          videoId: null,
          date: new Date(Date.now() - 259200000).toISOString(),
          platform: 'Japon Gourmet'
        },
        {
          title: 'EUSAKE: Sake Rice Grown in Europe',
          description: 'EUSAKE1 and EUSAKE2 are the first sake rice varieties developed by Yanmar R&D Europe. Cultivated by IRES (Italian Rice Experiment Station) in Italy, it represents a milestone in sustainable European sake production.',
          url: 'https://www.ires.online/home-english',
          source: 'news',
          imageUrl: null,
          videoId: null,
          date: new Date(Date.now() - 345600000).toISOString(),
          platform: 'IRES'
        },
        {
          title: 'Fuga Sake Presentation at Iberkampai',
          description: 'Fuga Sake was presented at Iberkampai, the first fair of gastronomy, sake and Japanese culture in Spain. An event celebrating the fusion between Japanese tradition and European innovation.',
          url: 'https://twitter.com/fugasake',
          source: 'social',
          imageUrl: null,
          videoId: null,
          date: new Date(Date.now() - 432000000).toISOString(),
          platform: 'Twitter/X'
        }
      ];
      
      return mockData;
    }
    
    function processResults(results) {
      // Remove duplicates and sort by date
      const seen = new Set();
      const unique = results.filter(item => {
        const key = item.url || item.title;
        if (seen.has(key)) return false;
        seen.add(key);
        return true;
      });
      
      return unique.sort((a, b) => 
        new Date(b.date) - new Date(a.date)
      );
    }
    
    async function generateSummary(data) {
      const summarySection = document.getElementById('summarySection');
      const summaryContent = document.getElementById('summaryContent');
      
      if (data.length === 0) {
        summarySection.style.display = 'none';
        return;
      }
      
      summarySection.style.display = 'block';
      summaryContent.innerHTML = '<div class="summary-loading">Generating summary...</div>';
      
      try {
        const dataText = data.slice(0, 10).map(item => 
          `${item.platform}: ${item.title} - ${item.description}`
        ).join('\n');
        
        const response = await fetch('https://api.anthropic.com/v1/messages', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            model: 'claude-sonnet-4-20250514',
            max_tokens: 1000,
            messages: [{
              role: 'user',
              content: `The following is the latest promotional activity information for Fuga Sake (brewed by Les Larmes du Levant in France, using Italian EUSAKE rice) sold in the Spanish market. Analyze this and create a concise summary in 3-4 sentences in English:

${dataText}

Focus on important events, sales channels, partnerships, and media coverage. Fuga Sake is a unique product that fuses Japanese tradition with European innovation.`
            }]
          })
        });
        
        const result = await response.json();
        const summary = result.content.find(c => c.type === 'text')?.text || 
          'View the latest promotional activities for Fuga Sake.';
        
        summaryContent.innerHTML = summary;
        
      } catch (error) {
        console.error('Summary generation error:', error);
        summaryContent.innerHTML = 'The latest promotional activities for Fuga Sake (Les Larmes du Levant, using EUSAKE rice) in the Spanish market have been updated. View each card for details.';
      }
    }
    
    function switchTab(tab) {
      currentTab = tab;
      
      // Update tab styles
      document.querySelectorAll('.tab').forEach(t => {
        t.classList.remove('active');
      });
      event.target.classList.add('active');
      
      // Display filtered content
      displayContent(tab);
    }
    
    function displayContent(filter) {
      const grid = document.getElementById('contentGrid');
      
      let filtered = allData;
      if (filter !== 'all') {
        filtered = allData.filter(item => item.source === filter);
      }
      
      if (filtered.length === 0) {
        grid.innerHTML = `
          <div class="empty-state">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.35-4.35"></path>
            </svg>
            <p>No data available in this category yet</p>
          </div>
        `;
        return;
      }
      
      grid.innerHTML = filtered.map(item => createCard(item)).join('');
    }
    
    function createCard(item) {
      const date = new Date(item.date);
      const formattedDate = date.toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      });
      
      let mediaHtml = '';
      if (item.videoId) {
        mediaHtml = `
          <div class="card-media video">
            <iframe 
              src="https://www.youtube.com/embed/${item.videoId}"
              allowfullscreen
            ></iframe>
          </div>
        `;
      } else if (item.imageUrl) {
        mediaHtml = `
          <div class="card-media">
            <img src="${item.imageUrl}" alt="${item.title}" onerror="this.parentElement.innerHTML='<span class=\\'media-placeholder\\'>ðŸ“¸</span>'">
          </div>
        `;
      } else {
        const icon = item.source === 'youtube' ? 'ðŸŽ¥' : 
                     item.source === 'social' ? 'ðŸ’¬' : 'ðŸ“°';
        mediaHtml = `
          <div class="card-media">
            <span class="media-placeholder">${icon}</span>
          </div>
        `;
      }
      
      return `
        <div class="content-card">
          ${mediaHtml}
          <div class="card-content">
            <span class="card-source">${item.platform}</span>
            <h3 class="card-title">${item.title}</h3>
            <p class="card-description">${item.description}</p>
            <div class="card-meta">
              <span class="card-date">${formattedDate}</span>
              <a href="${item.url}" target="_blank" class="card-link">View Details â†’</a>
            </div>
          </div>
        </div>
      `;
    }
  </script>
</body>
</html>
